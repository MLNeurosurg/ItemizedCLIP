2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Configure stats pid to 173020
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Loading settings from /home/yiweilyu/.config/wandb/settings
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Loading settings from /nfs/turbo/umms-tocho/code/yiwei/ItemizedCLIP/Radiology_Tasks/src/open_mri_train/wandb/settings
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'Radiology_Tasks/src/open_mri_train/main.py', 'program_abspath': '/nfs/turbo/umms-tocho/code/yiwei/ItemizedCLIP/Radiology_Tasks/src/open_mri_train/main.py', 'program': '/nfs/turbo/umms-tocho/code/yiwei/ItemizedCLIP/Radiology_Tasks/src/open_mri_train/main.py'}
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_setup.py:_flush():76] Applying login settings: {}
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:_log_setup():521] Logging user logs to /nfs/turbo/umms-tocho/code/yiwei/ItemizedCLIP/Radiology_Tasks/src/open_mri_train/wandb/run-20251205_112943-2025_12_05-11_29_15-model_HLIPSN_BiomedBERT_81616_itemizedclip-lr_0.000175-b_32-j_8-p_amp/logs/debug.log
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:_log_setup():522] Logging internal logs to /nfs/turbo/umms-tocho/code/yiwei/ItemizedCLIP/Radiology_Tasks/src/open_mri_train/wandb/run-20251205_112943-2025_12_05-11_29_15-model_HLIPSN_BiomedBERT_81616_itemizedclip-lr_0.000175-b_32-j_8-p_amp/logs/debug-internal.log
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:init():561] calling init triggers
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'train_data': 'train', 'train_data_upsampling_factors': None, 'val_data': 'valid', 'train_num_samples': None, 'val_num_samples': None, 'dataset_type': 'auto', 'dataset_resampled': False, 'use_serienames': True, 'alt_report': False, 'csv_separator': '\t', 'csv_img_key': 'filepath', 'csv_caption_key': 'title', 'imagenet_val': None, 'imagenet_v2': None, 'test_data': None, 'num_series': 10, 'context_length': 256, 'no_normal_check': False, 'comp_upfac': 1.5, 'key_token_alignment_loss': 1.0, 'key_token_thresh': 0.05, 'cache_dir': None, 'logs': '/scratch/tocho_root/tocho99/yiweilyu/logs/', 'log_local': False, 'name': '2025_12_05-11_29_15-model_HLIPSN_BiomedBERT_81616_itemizedclip-lr_0.000175-b_32-j_8-p_amp', 'workers': 8, 'batch_size': 8, 'epochs': 24, 'epochs_cooldown': None, 'lr': 0.000175, 'beta1': 0.9, 'beta2': 0.98, 'eps': 1e-06, 'wd': 0.2, 'momentum': None, 'warmup': 2000, 'opt': 'adamw', 'use_bn_sync': False, 'skip_scheduler': False, 'lr_scheduler': 'cosine', 'lr_cooldown_end': 0.0, 'lr_cooldown_power': 1.0, 'save_frequency': 1, 'save_most_recent': False, 'zeroshot_frequency': 1, 'val_frequency': 1, 'resume': None, 'precision': 'amp', 'model': 'HLIPSN_BiomedBERT_81616_itemizedclip', 'pretrained': '', 'pretrained_image': False, 'lock_image': False, 'lock_image_unlocked_groups': 0, 'lock_image_freeze_bn_stats': False, 'image_mean': None, 'image_std': None, 'image_interpolation': None, 'image_resize_mode': None, 'aug_cfg': {}, 'accum_batch': 4, 'grad_checkpointing': True, 'local_loss': False, 'gather_with_grad': False, 'force_image_size': None, 'force_quick_gelu': False, 'force_patch_dropout': None, 'force_custom_text': False, 'torchscript': False, 'torchcompile': False, 'trace': False, 'accum_freq': 1, 'device': 'cuda:0', 'dist_url': 'env://localhost:29423', 'dist_backend': None, 'report_to': 'wandb', 'wandb_notes': '', 'wandb_project_name': 'open-mri-itemizedclip', 'debug': False, 'copy_codebase': False, 'horovod': False, 'ddp_static_graph': False, 'no_set_device_rank': False, 'seed': 0, 'grad_clip_norm': None, 'lock_text': False, 'lock_text_unlocked_layers': 0, 'lock_text_freeze_layer_norm': False, 'log_every_n_steps': 100, 'coca_caption_loss_weight': 2.0, 'coca_contrastive_loss_weight': 1.0, 'remote_sync': None, 'remote_sync_frequency': 300, 'remote_sync_protocol': 's3', 'delete_previous_checkpoint': False, 'distill_model': None, 'distill_pretrained': None, 'use_bnb_linear': None, 'siglip': False, 'loss_dist_impl': None, 'is_ct': False, 'itemizedclip_text': False, 'custom_clip_loss': False, 'correct_false_negatives': False, 'report_replacer': '/nfs/turbo/umms-tocho/code/yiwei/mri_etl/yiwei_prototype/chatgpt/shortenedreportsMRI4omini.csv', 'use_itemizedclip_loss': True, 'add_mps_loss': True, 'iis_loss': 1.0, 'mps_fac': 0.01, 'ila_fac': 1.0, 'ila_mask_rate': 0.9, 'num_sampled_captions': 7, 'save_and_eval_every': 1, 'is_ct_rate': False, 'diverse_sampling': False, 'zeroshot_ct_rate': False, 'input_info': ['-1150', '350', 'crop'], 'use_cxr_bert': False, 'distributed': True, 'world_size': 8, 'rank': 0, 'local_rank': 0, 'log_path': '/scratch/tocho_root/tocho99/yiweilyu/logs/2025_12_05-11_29_15-model_HLIPSN_BiomedBERT_81616_itemizedclip-lr_0.000175-b_32-j_8-p_amp/out.log', 'log_level': 20, 'wandb': True, 'tensorboard': False, 'checkpoint_path': '/scratch/tocho_root/tocho99/yiweilyu/logs/2025_12_05-11_29_15-model_HLIPSN_BiomedBERT_81616_itemizedclip-lr_0.000175-b_32-j_8-p_amp/checkpoints', 'tensorboard_path': '', 'distill': False, 'save_logs': True, 'train_sz': 220001, 'val_sz': 992}
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:init():611] starting backend
2025-12-05 11:29:43,624 INFO    MainThread:173020 [wandb_init.py:init():615] setting up manager
2025-12-05 11:29:43,625 INFO    MainThread:173020 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-12-05 11:29:43,631 INFO    MainThread:173020 [wandb_init.py:init():623] backend started and connected
2025-12-05 11:29:43,636 INFO    MainThread:173020 [wandb_init.py:init():715] updated telemetry
2025-12-05 11:29:43,860 INFO    MainThread:173020 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2025-12-05 11:29:44,494 INFO    MainThread:173020 [wandb_run.py:_on_init():2357] communicating current version
2025-12-05 11:29:44,581 INFO    MainThread:173020 [wandb_run.py:_on_init():2366] got version response upgrade_message: "wandb version 0.23.1 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2025-12-05 11:29:44,581 INFO    MainThread:173020 [wandb_init.py:init():799] starting run threads in backend
2025-12-05 11:29:52,310 INFO    MainThread:173020 [wandb_run.py:_console_start():2335] atexit reg
2025-12-05 11:29:52,310 INFO    MainThread:173020 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2025-12-05 11:29:52,310 INFO    MainThread:173020 [wandb_run.py:_redirect():2255] Wrapping output streams.
2025-12-05 11:29:52,310 INFO    MainThread:173020 [wandb_run.py:_redirect():2280] Redirects installed.
2025-12-05 11:29:52,311 INFO    MainThread:173020 [wandb_init.py:init():842] run started, returning control to user process
